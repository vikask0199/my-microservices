eval $(minikube docker-env)
docker build -t user-service:latest ./user-service/

sudo snap install helm --classic
helm version

helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
helm repo update

helm install nginx-ingress ingress-nginx/ingress-nginx --namespace my-microservices --create-namespace


kubectl get pods -n my-microservices -l app.kubernetes.io/name=ingress-nginx

kubectl get svc -n my-microservices -l app.kubernetes.io/name=ingress-nginx

kubectl apply -f k8s/namespace.yaml
kubectl apply -f k8s/ingress/ingress.yaml

kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/cloud/deploy.yaml


# Apply order-service resources
kubectl apply -f k8s/order-service/configmap.yaml
kubectl apply -f k8s/order-service/deployment.yaml
kubectl apply -f k8s/order-service/hpa.yaml
kubectl apply -f k8s/order-service/service.yaml

# Apply user-service resources
kubectl apply -f k8s/user-service/configmap.yaml
kubectl apply -f k8s/user-service/deployment.yaml
kubectl apply -f k8s/user-service/hpa.yaml
kubectl apply -f k8s/user-service/service.yaml


kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/cloud/deploy.yaml

